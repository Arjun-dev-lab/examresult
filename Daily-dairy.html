<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Xylem School Diary â€” Generator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* small custom tweaks */
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace }
  </style>
</head>
<body class="bg-slate-50 min-h-screen p-6">
  <div class="max-w-3xl mx-auto bg-white shadow-md rounded-2xl p-6">
    <div class="flex items-center justify-between mb-4">
      <h1 class="text-2xl font-semibold">ðŸ“” Xylem School Diary â€” Generator</h1>
      <div class="text-sm text-slate-500">Static â€¢ Open in browser</div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mb-4">
      <div>
        <label class="block text-sm font-medium mb-1">Date</label>
        <input id="date" type="date" class="w-full rounded-md border p-2" />
      </div>

      <div>
        <label class="block text-sm font-medium mb-1">Class</label>
        <select id="classSelect" class="w-full rounded-md border p-2">
          <option>ISP GC J1 2025</option>
          <option>ISP GC J2 2025</option>
          <option>ISP GC N1 2025</option>
          <option>ISP GC N2 2025</option>
          <option>ISP GC N3 2025</option>
        </select>
      </div>

      <div>
        <label class="block text-sm font-medium mb-1">Stream (JEE / NEET)</label>
        <select id="stream" class="w-full rounded-md border p-2">
          <option value="jee">JEE</option>
          <option value="neet">NEET</option>
        </select>
      </div>
    </div>

    <div class="mb-4">
      <div class="flex items-center justify-between mb-2">
        <h2 class="font-medium">Sessions</h2>
        <div>
          <button id="addSession" class="px-3 py-1 bg-blue-600 text-white rounded-md mr-2">+ Add Session</button>
          <button id="clearSessions" class="px-3 py-1 bg-rose-500 text-white rounded-md">Clear</button>
        </div>
      </div>

      <div id="sessions" class="space-y-2">
        <!-- sessions will appear here -->
      </div>
    </div>

    <div class="mb-4">
      <button id="generate" class="px-4 py-2 bg-emerald-600 text-white rounded-md mr-2">Generate Diary Text</button>
      <button id="copyBtn" class="px-4 py-2 bg-sky-600 text-white rounded-md">Copy to Clipboard</button>
    </div>

    <div>
      <label class="block text-sm font-medium mb-1">Generated Diary (preview)</label>
      <textarea id="output" rows="10" class="w-full rounded-lg border p-3 mono" readonly></textarea>
    </div>

    <div class="mt-3 text-sm text-slate-500">Tips: Chapters are placeholders â€” change them to your real chapter names. Add as many sessions as needed.</div>
  </div>

  <script>
    // ---------- Placeholder chapters per subject (you will replace these) ----------
    const chapters = {
      // JEE subjects
      'English': ['The Portrait of a Lady', 'A Photograph', "We're Not Afraid to Die... if We Can All Be Together", 'Discovering Tut: the Saga Continues', 'The Laburnum Top', 'The Voice of the Rain', "The Ailing Planet: the Green Movement's Role", 'Childhood', 'The Adventure', 'Silk Road', 'Father to Son'],
      'Maths': ['Sets',
      'Relations and Functions',
      'Trigonometric Functions',
      'Complex Numbers and Quadratic Equations',
      'Linear Inequalities',
      'Permutations and Combinations',
      'Binomial Theorem',
      'Sequences and Series',
      'Straight Lines',
      'Conic Sections',
      'Introduction to Three Dimensional Geometry',
      'Limits and Derivatives',
      'Statistics',
      'Probability'],
      'Physics': [
        'Units and Measurements',
        'Motion in a Straight Line',
        'Motion in a Plane',
        'Laws of Motion',
        'Work, Energy and Power',
        'System of Particles and Rotational Motion',
        'Gravitation',
        'Mechanical Properties of Solids',
        'Mechanical Properties of Fluids',
        'Thermal Properties of Matter',
        'Thermodynamics',
        'Kinetic Theory',
        'Oscillations',
        'Waves'
        ],
      'Chemistry': [
        'Some Basic Concepts of Chemistry',
        'Structure of Atom',
        'Classification of Elements and Periodicity in Properties',
        'Chemical Bonding and Molecular Structure',
        'Thermodynamics',
        'Equilibrium',
        'Redox Reactions',
        'Organic Chemistry â€“ Some Basic Principles and Techniques',
        'Hydrocarbons'
          ],
      'Computer Science': [
            'Computer Systems and Organization',
            'Data Representation and Boolean Logic',
            'Getting Started with Python',
            'Python Programming Fundamentals',
            'Conditional and Looping Constructs',
            'Strings in Python',
            'Lists in Python',
            'Other Functions',
            'Tuples and Dictionary',
            'Society, Law and Ethics',
            'Cyber Safety'
        ],
      // NEET-only subjects
      'Botany': ['Chapter 1 (placeholder)','Chapter 2 (placeholder)'],
      'Zoology': ['Chapter 1 (placeholder)','Chapter 2 (placeholder)'],
    };

    const subjectsByStream = {
      jee: ['English','Maths','Physics','Chemistry','Computer Science'],
      neet: ['English','Maths','Physics','Chemistry','Botany','Zoology']
    };

    // ---------- Helpers ----------
    function formatDateForDisplay(iso) {
      if(!iso) return '';
      const d = new Date(iso);
      const opts = { day: '2-digit', month: 'long', year: 'numeric' };
      return d.toLocaleDateString(undefined, opts);
    }

    function todayISO() {
      const d = new Date();
      const y = d.getFullYear();
      const m = String(d.getMonth()+1).padStart(2,'0');
      const day = String(d.getDate()).padStart(2,'0');
      return `${y}-${m}-${day}`;
    }

    // ---------- Session UI management ----------
    const sessionsContainer = document.getElementById('sessions');
    const addBtn = document.getElementById('addSession');
    const clearBtn = document.getElementById('clearSessions');
    const streamSelect = document.getElementById('stream');
    const dateInput = document.getElementById('date');

    // set today's date
    dateInput.value = todayISO();

    function makeSubjectOptions(stream) {
      return subjectsByStream[stream].map(s => `<option value="${s}">${s}</option>`).join('');
    }

    function makeChapterOptions(subject) {
      const list = chapters[subject] || ['Chapter 1 (placeholder)'];
      return list.map(c => `<option value="${c}">${c}</option>`).join('');
    }

    let sessionCount = 0;

    function addSession(prefill={}){
      sessionCount++;
      const id = 'sess-'+Date.now()+Math.random().toString(36).slice(2,6);
      const stream = streamSelect.value;
      const subject = prefill.subject || (subjectsByStream[stream][0]);
      const type = prefill.type || 'THEORY';
      const chapter = prefill.chapter || (chapters[subject] ? chapters[subject][0] : 'Chapter 1 (placeholder)');
      const teacher = prefill.teacher || '';

      const wrapper = document.createElement('div');
      wrapper.className = 'p-3 border rounded-md bg-slate-50 flex flex-col md:flex-row md:items-center gap-2';
      wrapper.dataset.id = id;
      wrapper.innerHTML = `
        <div class="flex items-center gap-3 w-full md:w-auto">
          <div class="text-slate-600">Session</div>
          <div class="font-medium">${sessionCount}</div>
        </div>

        <div class="flex-1 grid grid-cols-1 md:grid-cols-4 gap-2 items-center">
          <div>
            <label class="sr-only">Subject</label>
            <select class="subject w-full rounded-md border p-2">${makeSubjectOptions(stream)}</select>
          </div>

          <div>
            <label class="sr-only">Type</label>
            <select class="type w-full rounded-md border p-2">
              <option>THEORY</option>
              <option>ENTRANCE</option>
            </select>
          </div>

          <div>
            <label class="sr-only">Chapter</label>
            <select class="chapter w-full rounded-md border p-2">${makeChapterOptions(subject)}</select>
          </div>

          <div>
            <label class="sr-only">Teacher</label>
            <input class="teacher w-full rounded-md border p-2" placeholder="Teacher initials" value="${teacher}" />
          </div>
        </div>

        <div class="flex items-center gap-2 mt-2 md:mt-0 md:ml-3">
          <button class="removeSession px-2 py-1 bg-rose-500 text-white rounded-md">Remove</button>
        </div>
      `;

      // set selected type and chapter in next tick
      sessionsContainer.appendChild(wrapper);
      const subjectEl = wrapper.querySelector('.subject');
      const typeEl = wrapper.querySelector('.type');
      const chapterEl = wrapper.querySelector('.chapter');

      // set values
      subjectEl.value = subject;
      typeEl.value = type;
      // repopulate chapters for the subject
      chapterEl.innerHTML = makeChapterOptions(subject);
      chapterEl.value = chapter;

      // events
      subjectEl.addEventListener('change', (e)=>{
        const sub = e.target.value;
        const chs = makeChapterOptions(sub);
        chapterEl.innerHTML = chs;
      });

      wrapper.querySelector('.removeSession').addEventListener('click', ()=>{
        wrapper.remove();
        // re-number session labels
        renumberSessions();
      });

      renumberSessions();
    }

    function renumberSessions(){
      const children = Array.from(sessionsContainer.children);
      children.forEach((c,i)=>{
        const label = c.querySelector('.font-medium');
        if(label) label.textContent = (i+1);
      });
      sessionCount = children.length;
    }

    // initial: add 4 sessions as a helpful default
    addSession({subject: 'Maths'});
    addSession({subject: 'Physics'});
    addSession({subject: 'Maths', type: 'ENTRANCE'});
    addSession({subject: 'Computer Science'});

    addBtn.addEventListener('click', ()=> addSession());
    clearBtn.addEventListener('click', ()=>{
      sessionsContainer.innerHTML = '';
      sessionCount = 0;
    });

    // when stream changes, update subject lists in existing sessions
    streamSelect.addEventListener('change', ()=>{
      const s = streamSelect.value;
      const subs = makeSubjectOptions(s);
      const subjectEls = document.querySelectorAll('.subject');
      subjectEls.forEach(el=>{
        const prev = el.value;
        el.innerHTML = subs;
        // if previous subject exists in new list, keep it; otherwise set first
        if([...el.options].some(o=>o.value===prev)) el.value = prev;
      });
      // also update chapter lists to match chosen subject
      document.querySelectorAll('.subject').forEach(el=>{
        const row = el.closest('div[prefix]') || el.parentElement.parentElement.parentElement;
        const chapterEl = row.querySelector('.chapter');
        if(chapterEl) chapterEl.innerHTML = makeChapterOptions(el.value);
      });
    });

    // ---------- Generate output ----------
    const output = document.getElementById('output');
    const generateBtn = document.getElementById('generate');
    const copyBtn = document.getElementById('copyBtn');

    function generateText(){
      const dateIso = dateInput.value;
      const dateDisplay = formatDateForDisplay(dateIso);
      const className = document.getElementById('classSelect').value;

      const lines = [];
      lines.push('*XYLEM SCHOOL DIARY ðŸ“”*');
      lines.push(`*Date: ${dateDisplay}*`);
      lines.push(`*Class: ${className}*`);
      lines.push('');

      const rows = Array.from(sessionsContainer.children);
      rows.forEach((r,i)=>{
        const subj = r.querySelector('.subject').value.toUpperCase();
        const type = r.querySelector('.type').value.toUpperCase();
        const chap = r.querySelector('.chapter').value;
        const teacher = r.querySelector('.teacher').value.toUpperCase() || '---';
        lines.push(`*Session ${i+1}: ${subj} ${type} - ${chap} - ${teacher}*`);
      });

      lines.push('');
      lines.push('*_ðŸ“šðŸ“šðŸ“šðŸ“šðŸ“šðŸ“šðŸ“š_*');

      const final = lines.join('\n');
      output.value = final;
      return final;
    }

    generateBtn.addEventListener('click', generateText);

    copyBtn.addEventListener('click', ()=>{
      const text = output.value || generateText();
      navigator.clipboard.writeText(text).then(()=>{
        copyBtn.textContent = 'Copied âœ“';
        setTimeout(()=> copyBtn.textContent = 'Copy to Clipboard', 1500);
      }).catch(()=>{
        alert('Copy failed â€” please select the text and copy manually.');
      });
    });

    // accessibility: allow Enter to add session when focused on add button
    addBtn.addEventListener('keyup', (e)=>{ if(e.key==='Enter') addSession(); });
  </script>
</body>
</html>
